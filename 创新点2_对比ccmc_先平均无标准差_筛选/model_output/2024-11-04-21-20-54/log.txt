Namespace(batch_size=16, cuda=True, datasetname='./scaler_ccmc_fits提取_筛选.csv', epochs=160, model_type='LLM_VIT', num_dataset=9, seed=2021)
./scaler_ccmc_fits提取_筛选.csv每一类的数量是: [3000, 320]
./scaler_ccmc_fits提取_筛选.csvget_Class函数得到的的权重： [0.5533333333333333, 5.1875]
./scaler_ccmc_fits提取_筛选.csv每一类的数量是: [3000, 320]
./scaler_ccmc_fits提取_筛选.csvget_Class函数得到的的权重： [0.5533333333333333, 5.1875]
./scaler_ccmc_fits提取_筛选.csv每一类的数量是: [3000, 320]
./scaler_ccmc_fits提取_筛选.csvget_Class函数得到的的权重： [0.5533333333333333, 5.1875]
(3320, 1)
(83,)
(3320, 1)
(83,)
(3320, 1)
(83,)
zero: 0.5533333333333333
zero: 5.1875
{0.0: 0.5533333333333333, 1.0: 5.1875}
====================数据集0测试集轮评估数据=============================================
[[73  2]
 [ 0  8]]
TSS: 0.9733333333333334
本轮评估完成 
Test set: Average loss: 4.2368, Accuracy: 81/83 (98%)

[[73  2]
 [ 0  8]]
data_FPR [0.         0.02666667]
Recall [0.97333333 1.        ]
Precision [1.  0.8]
Accuracy [0.97590361 0.97590361]
TSS [0.97333333 0.97333333]
HSS [0.87556222 0.87556222]
FAR [0.  0.2]
BS, BSS [0.07688956132211681, 0.11717968675322887]
数据集 0 测试集TSS: 0.9733333333333334
Namespace(batch_size=16, cuda=True, datasetname='./scaler_ccmc_fits提取_筛选.csv', epochs=160, model_type='LLM_VIT', num_dataset=9, seed=2021)
./scaler_ccmc_fits提取_筛选.csv每一类的数量是: [3000, 320]
./scaler_ccmc_fits提取_筛选.csvget_Class函数得到的的权重： [0.5533333333333333, 5.1875]
./scaler_ccmc_fits提取_筛选.csv每一类的数量是: [3000, 320]
./scaler_ccmc_fits提取_筛选.csvget_Class函数得到的的权重： [0.5533333333333333, 5.1875]
./scaler_ccmc_fits提取_筛选.csv每一类的数量是: [3000, 320]
./scaler_ccmc_fits提取_筛选.csvget_Class函数得到的的权重： [0.5533333333333333, 5.1875]
(3320, 1)
(83,)
(3320, 1)
(83,)
(3320, 1)
(83,)
zero: 0.5533333333333333
zero: 5.1875
{0.0: 0.5533333333333333, 1.0: 5.1875}
====================数据集1测试集轮评估数据=============================================
[[75  0]
 [ 2  6]]
TSS: 0.75
本轮评估完成 
Test set: Average loss: 2.2867, Accuracy: 81/83 (98%)

[[75  0]
 [ 2  6]]
data_FPR [0.25 0.  ]
Recall [1.   0.75]
Precision [0.97402597 1.        ]
Accuracy [0.97590361 0.97590361]
TSS [0.75 0.75]
HSS [0.84427767 0.84427767]
FAR [0.02597403 0.        ]
BS, BSS [0.03253288194541899, 0.626468293796681]
数据集 1 测试集TSS: 0.75
Namespace(batch_size=16, cuda=True, datasetname='./scaler_ccmc_fits提取_筛选.csv', epochs=160, model_type='LLM_VIT', num_dataset=9, seed=2021)
./scaler_ccmc_fits提取_筛选.csv每一类的数量是: [3000, 320]
./scaler_ccmc_fits提取_筛选.csvget_Class函数得到的的权重： [0.5533333333333333, 5.1875]
./scaler_ccmc_fits提取_筛选.csv每一类的数量是: [3000, 320]
./scaler_ccmc_fits提取_筛选.csvget_Class函数得到的的权重： [0.5533333333333333, 5.1875]
./scaler_ccmc_fits提取_筛选.csv每一类的数量是: [3000, 320]
./scaler_ccmc_fits提取_筛选.csvget_Class函数得到的的权重： [0.5533333333333333, 5.1875]
(3320, 1)
(83,)
(3320, 1)
(83,)
(3320, 1)
(83,)
zero: 0.5533333333333333
zero: 5.1875
{0.0: 0.5533333333333333, 1.0: 5.1875}
====================数据集2测试集轮评估数据=============================================
[[73  2]
 [ 0  8]]
TSS: 0.9733333333333334
本轮评估完成 
Test set: Average loss: 3.8722, Accuracy: 81/83 (98%)

[[73  2]
 [ 0  8]]
data_FPR [0.         0.02666667]
Recall [0.97333333 1.        ]
Precision [1.  0.8]
Accuracy [0.97590361 0.97590361]
TSS [0.97333333 0.97333333]
HSS [0.87556222 0.87556222]
FAR [0.  0.2]
BS, BSS [0.06603746097531665, 0.24177988556840602]
数据集 2 测试集TSS: 0.9733333333333334
Namespace(batch_size=16, cuda=True, datasetname='./scaler_ccmc_fits提取_筛选.csv', epochs=160, model_type='LLM_VIT', num_dataset=9, seed=2021)
./scaler_ccmc_fits提取_筛选.csv每一类的数量是: [3000, 320]
./scaler_ccmc_fits提取_筛选.csvget_Class函数得到的的权重： [0.5533333333333333, 5.1875]
./scaler_ccmc_fits提取_筛选.csv每一类的数量是: [3000, 320]
./scaler_ccmc_fits提取_筛选.csvget_Class函数得到的的权重： [0.5533333333333333, 5.1875]
./scaler_ccmc_fits提取_筛选.csv每一类的数量是: [3000, 320]
./scaler_ccmc_fits提取_筛选.csvget_Class函数得到的的权重： [0.5533333333333333, 5.1875]
(3320, 1)
(83,)
(3320, 1)
(83,)
(3320, 1)
(83,)
zero: 0.5533333333333333
zero: 5.1875
{0.0: 0.5533333333333333, 1.0: 5.1875}
====================数据集3测试集轮评估数据=============================================
[[73  2]
 [ 0  8]]
TSS: 0.9733333333333334
本轮评估完成 
Test set: Average loss: 4.2753, Accuracy: 81/83 (98%)

[[73  2]
 [ 0  8]]
data_FPR [0.         0.02666667]
Recall [0.97333333 1.        ]
Precision [1.  0.8]
Accuracy [0.97590361 0.97590361]
TSS [0.97333333 0.97333333]
HSS [0.87556222 0.87556222]
FAR [0.  0.2]
BS, BSS [0.07837743439244219, 0.10009642411744302]
数据集 3 测试集TSS: 0.9733333333333334
Namespace(batch_size=16, cuda=True, datasetname='./scaler_ccmc_fits提取_筛选.csv', epochs=160, model_type='LLM_VIT', num_dataset=9, seed=2021)
./scaler_ccmc_fits提取_筛选.csv每一类的数量是: [3000, 320]
./scaler_ccmc_fits提取_筛选.csvget_Class函数得到的的权重： [0.5533333333333333, 5.1875]
./scaler_ccmc_fits提取_筛选.csv每一类的数量是: [3000, 320]
./scaler_ccmc_fits提取_筛选.csvget_Class函数得到的的权重： [0.5533333333333333, 5.1875]
./scaler_ccmc_fits提取_筛选.csv每一类的数量是: [3000, 320]
./scaler_ccmc_fits提取_筛选.csvget_Class函数得到的的权重： [0.5533333333333333, 5.1875]
(3320, 1)
(83,)
(3320, 1)
(83,)
(3320, 1)
(83,)
zero: 0.5533333333333333
zero: 5.1875
{0.0: 0.5533333333333333, 1.0: 5.1875}
====================数据集4测试集轮评估数据=============================================
[[75  0]
 [ 3  5]]
TSS: 0.625
本轮评估完成 
Test set: Average loss: 4.3489, Accuracy: 80/83 (96%)

[[75  0]
 [ 3  5]]
data_FPR [0.375 0.   ]
Recall [1.    0.625]
Precision [0.96153846 1.        ]
Accuracy [0.96385542 0.96385542]
TSS [0.625 0.625]
HSS [0.75075075 0.75075075]
FAR [0.03846154 0.        ]
BS, BSS [0.07665639599087463, 0.1198568133647745]
数据集 4 测试集TSS: 0.625
Namespace(batch_size=16, cuda=True, datasetname='./scaler_ccmc_fits提取_筛选.csv', epochs=160, model_type='LLM_VIT', num_dataset=9, seed=2021)
./scaler_ccmc_fits提取_筛选.csv每一类的数量是: [3000, 320]
./scaler_ccmc_fits提取_筛选.csvget_Class函数得到的的权重： [0.5533333333333333, 5.1875]
./scaler_ccmc_fits提取_筛选.csv每一类的数量是: [3000, 320]
./scaler_ccmc_fits提取_筛选.csvget_Class函数得到的的权重： [0.5533333333333333, 5.1875]
./scaler_ccmc_fits提取_筛选.csv每一类的数量是: [3000, 320]
./scaler_ccmc_fits提取_筛选.csvget_Class函数得到的的权重： [0.5533333333333333, 5.1875]
(3320, 1)
(83,)
(3320, 1)
(83,)
(3320, 1)
(83,)
zero: 0.5533333333333333
zero: 5.1875
{0.0: 0.5533333333333333, 1.0: 5.1875}
====================数据集5测试集轮评估数据=============================================
[[75  0]
 [ 2  6]]
TSS: 0.75
本轮评估完成 
Test set: Average loss: 1.9986, Accuracy: 81/83 (98%)

[[75  0]
 [ 2  6]]
data_FPR [0.25 0.  ]
Recall [1.   0.75]
Precision [0.97402597 1.        ]
Accuracy [0.97590361 0.97590361]
TSS [0.75 0.75]
HSS [0.84427767 0.84427767]
FAR [0.02597403 0.        ]
BS, BSS [0.02818129638860328, 0.6764317486315201]
数据集 5 测试集TSS: 0.75
Namespace(batch_size=16, cuda=True, datasetname='./scaler_ccmc_fits提取_筛选.csv', epochs=160, model_type='LLM_VIT', num_dataset=9, seed=2021)
./scaler_ccmc_fits提取_筛选.csv每一类的数量是: [3000, 320]
./scaler_ccmc_fits提取_筛选.csvget_Class函数得到的的权重： [0.5533333333333333, 5.1875]
./scaler_ccmc_fits提取_筛选.csv每一类的数量是: [3000, 320]
./scaler_ccmc_fits提取_筛选.csvget_Class函数得到的的权重： [0.5533333333333333, 5.1875]
./scaler_ccmc_fits提取_筛选.csv每一类的数量是: [3000, 320]
./scaler_ccmc_fits提取_筛选.csvget_Class函数得到的的权重： [0.5533333333333333, 5.1875]
(3320, 1)
(83,)
(3320, 1)
(83,)
(3320, 1)
(83,)
zero: 0.5533333333333333
zero: 5.1875
{0.0: 0.5533333333333333, 1.0: 5.1875}
====================数据集6测试集轮评估数据=============================================
[[74  1]
 [ 0  8]]
TSS: 0.9866666666666667
本轮评估完成 
Test set: Average loss: 3.6622, Accuracy: 82/83 (99%)

[[74  1]
 [ 0  8]]
data_FPR [0.         0.01333333]
Recall [0.98666667 1.        ]
Precision [1.         0.88888889]
Accuracy [0.98795181 0.98795181]
TSS [0.98666667 0.98666667]
HSS [0.93449092 0.93449092]
FAR [0.         0.11111111]
BS, BSS [0.06050701974783295, 0.30527856826196476]
数据集 6 测试集TSS: 0.9866666666666667
Namespace(batch_size=16, cuda=True, datasetname='./scaler_ccmc_fits提取_筛选.csv', epochs=160, model_type='LLM_VIT', num_dataset=9, seed=2021)
./scaler_ccmc_fits提取_筛选.csv每一类的数量是: [3000, 320]
./scaler_ccmc_fits提取_筛选.csvget_Class函数得到的的权重： [0.5533333333333333, 5.1875]
./scaler_ccmc_fits提取_筛选.csv每一类的数量是: [3000, 320]
./scaler_ccmc_fits提取_筛选.csvget_Class函数得到的的权重： [0.5533333333333333, 5.1875]
./scaler_ccmc_fits提取_筛选.csv每一类的数量是: [3000, 320]
./scaler_ccmc_fits提取_筛选.csvget_Class函数得到的的权重： [0.5533333333333333, 5.1875]
(3320, 1)
(83,)
(3320, 1)
(83,)
(3320, 1)
(83,)
zero: 0.5533333333333333
zero: 5.1875
{0.0: 0.5533333333333333, 1.0: 5.1875}
====================数据集7测试集轮评估数据=============================================
[[73  2]
 [ 0  8]]
TSS: 0.9733333333333334
本轮评估完成 
Test set: Average loss: 4.3548, Accuracy: 81/83 (98%)

[[73  2]
 [ 0  8]]
data_FPR [0.         0.02666667]
Recall [0.97333333 1.        ]
Precision [1.  0.8]
Accuracy [0.97590361 0.97590361]
TSS [0.97333333 0.97333333]
HSS [0.87556222 0.87556222]
FAR [0.  0.2]
BS, BSS [0.07994529482926241, 0.08209477320201886]
数据集 7 测试集TSS: 0.9733333333333334
Namespace(batch_size=16, cuda=True, datasetname='./scaler_ccmc_fits提取_筛选.csv', epochs=160, model_type='LLM_VIT', num_dataset=9, seed=2021)
./scaler_ccmc_fits提取_筛选.csv每一类的数量是: [3000, 320]
./scaler_ccmc_fits提取_筛选.csvget_Class函数得到的的权重： [0.5533333333333333, 5.1875]
./scaler_ccmc_fits提取_筛选.csv每一类的数量是: [3000, 320]
./scaler_ccmc_fits提取_筛选.csvget_Class函数得到的的权重： [0.5533333333333333, 5.1875]
./scaler_ccmc_fits提取_筛选.csv每一类的数量是: [3000, 320]
./scaler_ccmc_fits提取_筛选.csvget_Class函数得到的的权重： [0.5533333333333333, 5.1875]
(3320, 1)
(83,)
(3320, 1)
(83,)
(3320, 1)
(83,)
zero: 0.5533333333333333
zero: 5.1875
{0.0: 0.5533333333333333, 1.0: 5.1875}
====================数据集8测试集轮评估数据=============================================
[[73  2]
 [ 0  8]]
TSS: 0.9733333333333334
本轮评估完成 
Test set: Average loss: 4.0402, Accuracy: 81/83 (98%)

[[73  2]
 [ 0  8]]
data_FPR [0.         0.02666667]
Recall [0.97333333 1.        ]
Precision [1.  0.8]
Accuracy [0.97590361 0.97590361]
TSS [0.97333333 0.97333333]
HSS [0.87556222 0.87556222]
FAR [0.  0.2]
BS, BSS [0.07079557253808762, 0.1871488346418574]
数据集 8 测试集TSS: 0.9733333333333334
Namespace(batch_size=16, cuda=True, datasetname='./scaler_ccmc_fits提取_筛选.csv', epochs=160, model_type='LLM_VIT', num_dataset=9, seed=2021)
./scaler_ccmc_fits提取_筛选.csv每一类的数量是: [3000, 320]
./scaler_ccmc_fits提取_筛选.csvget_Class函数得到的的权重： [0.5533333333333333, 5.1875]
./scaler_ccmc_fits提取_筛选.csv每一类的数量是: [3000, 320]
./scaler_ccmc_fits提取_筛选.csvget_Class函数得到的的权重： [0.5533333333333333, 5.1875]
./scaler_ccmc_fits提取_筛选.csv每一类的数量是: [3000, 320]
./scaler_ccmc_fits提取_筛选.csvget_Class函数得到的的权重： [0.5533333333333333, 5.1875]
(3320, 1)
(83,)
(3320, 1)
(83,)
(3320, 1)
(83,)
zero: 0.5533333333333333
zero: 5.1875
{0.0: 0.5533333333333333, 1.0: 5.1875}
====================数据集9测试集轮评估数据=============================================
[[73  2]
 [ 0  8]]
TSS: 0.9733333333333334
本轮评估完成 
Test set: Average loss: 3.2489, Accuracy: 81/83 (98%)

[[73  2]
 [ 0  8]]
data_FPR [0.         0.02666667]
Recall [0.97333333 1.        ]
Precision [1.  0.8]
Accuracy [0.97590361 0.97590361]
TSS [0.97333333 0.97333333]
HSS [0.87556222 0.87556222]
FAR [0.  0.2]
BS, BSS [0.053960686606913236, 0.3804413832749579]
数据集 9 测试集TSS: 0.9733333333333334
#接下来计算所有测试集指标均值和方法
结果已写入 ./model_output/2024-11-04-21-20-54/results.xlsx
程序运行时间: 0.12 分钟
=============================================================第一种先取概率One平均进行对齐========================================================
++++++++++++++++++循环累加取平均值++++++++++++++++++++++++++++++++++
++++++++++++++++++ get叶180NOAAID_方便拼接csv++++++++++++++++++++++++++++++++++
++++++++++++++++++ 拿出40的一个拼起来与概率++++++++++++++++++++++++++++++++++
Averaged probabilities with NOAAID values saved to 'average_probabilities_with_noaaid.csv'
++++++++++++++++++ 根据NOAAID进行匹配拼接++++++++++++++++++++++++++++++++++
文件已更新，添加 y_true 列，并保存至 '对齐CSV概率与complete_TSS.csv'
++++++++++++++++++循环累加取平均值++++++++++++++++++++++++++++++++++
++++++++++++++++++ get叶180NOAAID_方便拼接csv++++++++++++++++++++++++++++++++++
++++++++++++++++++ 拿出40的一个拼起来与概率++++++++++++++++++++++++++++++++++
Averaged probabilities with NOAAID values saved to 'average_probabilities_with_noaaid.csv'
++++++++++++++++++ 根据NOAAID进行匹配拼接++++++++++++++++++++++++++++++++++
文件已更新，添加 y_true 列，并保存至 '对齐CSV概率与complete_BSS.csv'
=============================================================绘图One与Mplus概率阈值图========================================================
0.0
0.0
0.058823529411764705
0.11764705882352941
0.17647058823529413
0.23529411764705882
0.29411764705882354
0.7058823529411765
0.8235294117647058
0.9411764705882353
0.9411764705882353
0.9411764705882353
0.9411764705882353
0.75
0.75
0.75
0.5
0.25
0.0
0.75
0.5
0.5
0.25
0.25
0.25
0.25
0.25
0.25
0.0
0.0
0.0
0.0
0.0
0.0
0.0
0.0
0.0
0.0
0.0
0.0
0.11764705882352941
0.17647058823529413
0.29411764705882354
0.7058823529411765
0.9411764705882353
0.9411764705882353
0.9411764705882353
1.0
0.75
0.75
0.75
0.5
0.25
0.25
0.25
0.0
0.0
0.75
0.5
0.5
0.25
0.25
0.25
0.25
0.25
0.25
0.0
0.0
0.0
0.0
0.0
0.0
0.0
0.0
0.0
0.0
=============================================================绘图One与Mplus最优TSS指标计算========================================================
   Threshold Metric Name/BS and BSS   Class 0 Value  Class 1 Value
0        0.5                Accuracy       0.952381       0.952381
1        0.5                  Recall       0.941176       1.000000
2        0.5               Precision       1.000000       0.800000
3        0.5                     TSS       0.941176       0.941176
4        0.5                     HSS       0.859060       0.859060
5        0.5                     FAR       0.000000       0.200000
6        0.5                     FPR       0.000000       0.058824
结果已保存到 one_TSS_BestTSS_metrics_results.csv
   Threshold Metric Name/BS and BSS   Class 0 Value  Class 1 Value
0       0.05                Accuracy       0.952381       0.952381
1       0.05                  Recall       1.000000       0.750000
2       0.05               Precision       0.944444       1.000000
3       0.05                     TSS       0.750000       0.750000
4       0.05                     HSS       0.829268       0.829268
5       0.05                     FAR       0.055556       0.000000
6       0.05                     FPR       0.250000       0.000000
结果已保存到 MPlus_TSS_BestTSS_metrics_results.csv
   Threshold Metric Name/BS and BSS   Class 0 Value  Class 1 Value
0        0.5                Accuracy       1.000000       1.000000
1        0.5                  Recall       1.000000       1.000000
2        0.5               Precision       1.000000       1.000000
3        0.5                     BSS       0.082223       0.466763
4        0.5                     HSS       1.000000       1.000000
5        0.5                     FAR       0.000000       0.000000
6        0.5                     FPR       0.000000       0.000000
结果已保存到 one_BSS_BestTSS_metrics_results.csv
   Threshold Metric Name/BS and BSS   Class 0 Value  Class 1 Value
0       0.05                Accuracy       0.952381       0.952381
1       0.05                  Recall       1.000000       0.750000
2       0.05               Precision       0.944444       1.000000
3       0.05                     BSS       0.131658       0.146156
4       0.05                     HSS       0.829268       0.829268
5       0.05                     FAR       0.055556       0.000000
6       0.05                     FPR       0.250000       0.000000
结果已保存到 MPlus_BSS_BestTSS_metrics_results.csv
